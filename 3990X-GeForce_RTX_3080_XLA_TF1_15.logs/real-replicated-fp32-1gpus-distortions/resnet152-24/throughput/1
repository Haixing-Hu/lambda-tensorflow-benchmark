2020-09-21 08:35:51.157291: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
2020-09-21 08:35:52.594405: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2899965000 Hz
2020-09-21 08:35:52.594550: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x569ee50 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-21 08:35:52.594567: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-21 08:35:52.596074: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-21 08:35:52.708412: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5652560 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-21 08:35:52.708427: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3080, Compute Capability 8.6
2020-09-21 08:35:52.708904: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1634] Found device 0 with properties:
name: GeForce RTX 3080 major: 8 minor: 6 memoryClockRate(GHz): 1.755
pciBusID: 0000:01:00.0
2020-09-21 08:35:52.708916: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-21 08:35:52.710419: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-21 08:35:52.711081: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-21 08:35:52.711222: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-21 08:35:52.712742: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-21 08:35:52.713099: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-21 08:35:52.713182: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-21 08:35:52.724373: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1762] Adding visible gpu devices: 0
2020-09-21 08:35:52.724394: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-21 08:35:52.919169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1175] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-21 08:35:52.919203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181]      0
2020-09-21 08:35:52.919208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1194] 0:   N
2020-09-21 08:35:52.920166: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-09-21 08:35:52.920190: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1320] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9030 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3080, pci bus id: 0000:01:00.0, compute capability: 8.6)
TensorFlow:  1.15
Model:       resnet152
Dataset:     imagenet
Mode:        training
SingleSess:  False
Batch size:  24 global
24 per device
Num batches: 500
Num epochs:  0.01
Devices:     ['/gpu:0']
NUMA bind:   False
Data format: NCHW
Optimizer:   sgd
Variables:   replicated
AllReduce:   nccl
==========
Generating training model
2020-09-21 08:35:54.039506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1634] Found device 0 with properties:
name: GeForce RTX 3080 major: 8 minor: 6 memoryClockRate(GHz): 1.755
pciBusID: 0000:01:00.0
2020-09-21 08:35:54.039541: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-21 08:35:54.039566: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-21 08:35:54.039575: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-21 08:35:54.039582: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-21 08:35:54.039590: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-21 08:35:54.039597: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-21 08:35:54.039605: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-21 08:35:54.040349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1762] Adding visible gpu devices: 0
WARNING:tensorflow:Entity <function distort_color at 0x7fc9b996c6a8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x7fc9a7ffb780>
W0921 08:35:54.291056 140510914275136 ag_logging.py:146] Entity <function distort_color at 0x7fc9b996c6a8> could not be transformed and will be executed as-is. Please report this to the AutoGraph team. When filing the bug, set the verbosity to 10 (on Linux, `export AUTOGRAPH_VERBOSITY=10`) and attach the full output. Cause: If not matching a CFG node, must be a block statement: <gast.gast.ImportFrom object at 0x7fc9a7ffb780>
WARNING:tensorflow:The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
W0921 08:35:54.293598 140510914275136 image_ops_impl.py:1776] The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
WARNING:tensorflow:The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
W0921 08:35:54.295703 140510914275136 image_ops_impl.py:1776] The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
WARNING:tensorflow:The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
W0921 08:35:54.297769 140510914275136 image_ops_impl.py:1776] The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
WARNING:tensorflow:The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
W0921 08:35:54.299825 140510914275136 image_ops_impl.py:1776] The operation `tf.image.convert_image_dtype` will be skipped since the input and output dtypes are identical.
/usr/local/lib/python3.6/dist-packages/tensorflow_core/python/data/ops/dataset_ops.py:1422: UserWarning: Seed 1234 from outer graph might be getting used by function tf_data_experimental_map_and_batch_RecordInputImagePreprocessor.parse_and_preprocess, if the random op has not been provided any seed. Explicitly set the seed in the function if this is not the intended behavior.
dataset = transformation_func(self)
WARNING:tensorflow:GPU prefetching has been deactivated in your `tf.data` pipeline. It is not compatible with `MultiDeviceIterator`.
W0921 08:35:54.374424 140510914275136 dataset_ops.py:1829] GPU prefetching has been deactivated in your `tf.data` pipeline. It is not compatible with `MultiDeviceIterator`.
Initializing graph
2020-09-21 08:35:59.545825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1634] Found device 0 with properties:
name: GeForce RTX 3080 major: 8 minor: 6 memoryClockRate(GHz): 1.755
pciBusID: 0000:01:00.0
2020-09-21 08:35:59.545863: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-21 08:35:59.545884: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-21 08:35:59.545891: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-21 08:35:59.545897: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-21 08:35:59.545904: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-21 08:35:59.545909: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-21 08:35:59.545916: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-21 08:35:59.546673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1762] Adding visible gpu devices: 0
2020-09-21 08:35:59.546699: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1175] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-21 08:35:59.546704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181]      0
2020-09-21 08:35:59.546708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1194] 0:   N
2020-09-21 08:35:59.547474: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1320] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9030 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3080, pci bus id: 0000:01:00.0, compute capability: 8.6)
2020-09-21 08:36:00.666874: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1648] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0921 08:36:00.829210 140510914275136 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0921 08:36:01.066884 140510914275136 session_manager.py:502] Done running local_init_op.
Running warm up
2020-09-21 08:36:05.508318: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-21 08:36:05.992910: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-21 08:36:07.052816: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Internal: ptxas exited with non-zero error code 65280, output: ptxas fatal   : Value 'sm_86' is not defined for option 'gpu-name'

Relying on driver to perform ptx compilation. This message will be only logged once.
2020-09-21 08:41:54.741177: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:70] Can't find ptxas binary in ${CUDA_DIR}/bin.  Will back to the GPU driver for PTX -> sass compilation.  This is OK so long as you don't see a warning below about an out-of-date driver version.
2020-09-21 08:41:54.741211: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:71] Searched for CUDA in the following directories:
2020-09-21 08:41:54.741221: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   ./cuda_sdk_lib
2020-09-21 08:41:54.741225: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   /usr/local/cuda
2020-09-21 08:41:54.741229: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   .
2020-09-21 08:41:54.741234: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:76] You can choose the search directory by setting xla_gpu_cuda_data_dir in HloModule's DebugOptions.  For most apps, setting the environment variable XLA_FLAGS=--xla_gpu_cuda_data_dir=/path/to/cuda will work.
2020-09-21 08:41:54.741845: I tensorflow/compiler/jit/xla_compilation_cache.cc:237] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2020-09-21 08:41:56.735805: W tensorflow/compiler/xla/service/gpu/buffer_comparator.cc:590] Internal: ptxas exited with non-zero error code 65280, output: ptxas fatal   : Value 'sm_86' is not defined for option 'gpu-name'

Relying on driver to perform ptx compilation. This message will be only logged once.
2020-09-21 08:46:04.476598: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:70] Can't find ptxas binary in ${CUDA_DIR}/bin.  Will back to the GPU driver for PTX -> sass compilation.  This is OK so long as you don't see a warning below about an out-of-date driver version.
2020-09-21 08:46:04.476634: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:71] Searched for CUDA in the following directories:
2020-09-21 08:46:04.476644: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   ./cuda_sdk_lib
2020-09-21 08:46:04.476648: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   /usr/local/cuda
2020-09-21 08:46:04.476653: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   .
2020-09-21 08:46:04.476657: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:76] You can choose the search directory by setting xla_gpu_cuda_data_dir in HloModule's DebugOptions.  For most apps, setting the environment variable XLA_FLAGS=--xla_gpu_cuda_data_dir=/path/to/cuda will work.
2020-09-21 08:46:14.917070: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:70] Can't find ptxas binary in ${CUDA_DIR}/bin.  Will back to the GPU driver for PTX -> sass compilation.  This is OK so long as you don't see a warning below about an out-of-date driver version.
2020-09-21 08:46:14.917106: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:71] Searched for CUDA in the following directories:
2020-09-21 08:46:14.917116: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   ./cuda_sdk_lib
2020-09-21 08:46:14.917121: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   /usr/local/cuda
2020-09-21 08:46:14.917125: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   .
2020-09-21 08:46:14.917130: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:76] You can choose the search directory by setting xla_gpu_cuda_data_dir in HloModule's DebugOptions.  For most apps, setting the environment variable XLA_FLAGS=--xla_gpu_cuda_data_dir=/path/to/cuda will work.
Done warm up
Step	Img/sec	total_loss
1	images/sec: 143.9 +/- 0.0 (jitter = 0.0)	8.900 1600677977
10	images/sec: 144.3 +/- 0.2 (jitter = 0.6)	9.142 1600677978
20	images/sec: 144.1 +/- 0.2 (jitter = 0.6)	8.812 1600677980
30	images/sec: 144.0 +/- 0.1 (jitter = 0.6)	8.573 1600677981
40	images/sec: 143.9 +/- 0.1 (jitter = 0.6)	9.133 1600677983
50	images/sec: 143.9 +/- 0.1 (jitter = 0.6)	8.732 1600677985
60	images/sec: 143.8 +/- 0.1 (jitter = 0.6)	9.066 1600677986
70	images/sec: 143.7 +/- 0.1 (jitter = 0.7)	8.616 1600677988
80	images/sec: 143.6 +/- 0.1 (jitter = 0.8)	8.669 1600677990
90	images/sec: 143.5 +/- 0.1 (jitter = 0.8)	8.579 1600677991
100	images/sec: 143.4 +/- 0.1 (jitter = 0.8)	8.866 1600677993
110	images/sec: 143.3 +/- 0.1 (jitter = 0.9)	8.789 1600677995
120	images/sec: 143.3 +/- 0.1 (jitter = 0.9)	8.988 1600677996
130	images/sec: 143.2 +/- 0.1 (jitter = 0.9)	9.330 1600677998
140	images/sec: 143.2 +/- 0.1 (jitter = 0.9)	9.256 1600678000
150	images/sec: 143.2 +/- 0.1 (jitter = 0.9)	8.828 1600678002
160	images/sec: 143.2 +/- 0.1 (jitter = 0.9)	8.997 1600678003
170	images/sec: 143.1 +/- 0.1 (jitter = 1.0)	8.844 1600678005
180	images/sec: 143.1 +/- 0.1 (jitter = 1.0)	8.557 1600678007
190	images/sec: 143.1 +/- 0.1 (jitter = 1.0)	8.759 1600678008
200	images/sec: 143.1 +/- 0.1 (jitter = 0.9)	8.695 1600678010
210	images/sec: 143.1 +/- 0.1 (jitter = 0.9)	9.208 1600678012
220	images/sec: 143.0 +/- 0.1 (jitter = 0.9)	8.926 1600678013
230	images/sec: 143.0 +/- 0.1 (jitter = 1.0)	8.762 1600678015
240	images/sec: 143.0 +/- 0.1 (jitter = 1.0)	9.251 1600678017
250	images/sec: 142.9 +/- 0.1 (jitter = 1.0)	8.433 1600678018
260	images/sec: 142.9 +/- 0.1 (jitter = 1.0)	8.650 1600678020
270	images/sec: 142.9 +/- 0.1 (jitter = 1.0)	8.998 1600678022
280	images/sec: 142.9 +/- 0.1 (jitter = 0.9)	8.986 1600678023
290	images/sec: 142.9 +/- 0.1 (jitter = 0.9)	8.510 1600678025
300	images/sec: 142.9 +/- 0.1 (jitter = 0.9)	8.952 1600678027
310	images/sec: 142.8 +/- 0.1 (jitter = 0.9)	8.886 1600678028
320	images/sec: 142.8 +/- 0.1 (jitter = 0.9)	9.032 1600678030
330	images/sec: 142.8 +/- 0.1 (jitter = 1.0)	8.944 1600678032
340	images/sec: 142.7 +/- 0.1 (jitter = 1.0)	8.707 1600678034
350	images/sec: 142.7 +/- 0.1 (jitter = 1.0)	8.764 1600678035
360	images/sec: 142.7 +/- 0.1 (jitter = 1.0)	8.647 1600678037
370	images/sec: 142.7 +/- 0.0 (jitter = 1.0)	9.179 1600678039
380	images/sec: 142.7 +/- 0.0 (jitter = 1.0)	8.857 1600678040
390	images/sec: 142.6 +/- 0.0 (jitter = 1.0)	8.898 1600678042
400	images/sec: 142.6 +/- 0.0 (jitter = 1.0)	8.759 1600678044
410	images/sec: 142.6 +/- 0.0 (jitter = 1.0)	9.087 1600678045
420	images/sec: 142.6 +/- 0.0 (jitter = 1.0)	8.949 1600678047
430	images/sec: 142.5 +/- 0.0 (jitter = 1.0)	8.824 1600678049
440	images/sec: 142.5 +/- 0.0 (jitter = 0.9)	8.562 1600678050
450	images/sec: 142.5 +/- 0.0 (jitter = 0.9)	8.872 1600678052
460	images/sec: 142.5 +/- 0.0 (jitter = 0.9)	8.671 1600678054
470	images/sec: 142.5 +/- 0.0 (jitter = 0.9)	8.664 1600678056
480	images/sec: 142.5 +/- 0.0 (jitter = 1.0)	8.824 1600678057
490	images/sec: 142.5 +/- 0.0 (jitter = 0.9)	8.625 1600678059
500	images/sec: 142.4 +/- 0.0 (jitter = 0.9)	8.906 1600678061
----------------------------------------------------------------
total images/sec: 142.40
----------------------------------------------------------------
