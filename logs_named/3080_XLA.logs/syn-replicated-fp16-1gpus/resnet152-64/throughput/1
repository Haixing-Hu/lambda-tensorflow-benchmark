2020-09-21 15:18:58.565164: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
2020-09-21 15:18:59.978400: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2899965000 Hz
2020-09-21 15:18:59.978562: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x51cb2f0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-09-21 15:18:59.978592: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-09-21 15:18:59.980967: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcuda.so.1
2020-09-21 15:19:00.105206: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5411b70 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-09-21 15:19:00.105230: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce RTX 3080, Compute Capability 8.6
2020-09-21 15:19:00.106058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1634] Found device 0 with properties:
name: GeForce RTX 3080 major: 8 minor: 6 memoryClockRate(GHz): 1.755
pciBusID: 0000:01:00.0
2020-09-21 15:19:00.106080: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-21 15:19:00.108759: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-21 15:19:00.109943: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-21 15:19:00.110218: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-21 15:19:00.113064: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-21 15:19:00.113730: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-21 15:19:00.113876: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-21 15:19:00.115109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1762] Adding visible gpu devices: 0
2020-09-21 15:19:00.115129: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-21 15:19:00.329996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1175] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-21 15:19:00.330037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181]      0
2020-09-21 15:19:00.330041: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1194] 0:   N
2020-09-21 15:19:00.331031: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-09-21 15:19:00.331055: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1320] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9031 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3080, pci bus id: 0000:01:00.0, compute capability: 8.6)
TensorFlow:  1.15
Model:       resnet152
Dataset:     imagenet (synthetic)
Mode:        training
SingleSess:  False
Batch size:  64 global
64 per device
Num batches: 500
Num epochs:  0.02
Devices:     ['/gpu:0']
NUMA bind:   False
Data format: NCHW
Optimizer:   sgd
Variables:   replicated
AllReduce:   nccl
==========
Generating training model
Initializing graph
2020-09-21 15:19:06.146079: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1634] Found device 0 with properties:
name: GeForce RTX 3080 major: 8 minor: 6 memoryClockRate(GHz): 1.755
pciBusID: 0000:01:00.0
2020-09-21 15:19:06.146116: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudart.so.11.0
2020-09-21 15:19:06.146137: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-21 15:19:06.146145: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcufft.so.10
2020-09-21 15:19:06.146152: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcurand.so.10
2020-09-21 15:19:06.146158: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusolver.so.10
2020-09-21 15:19:06.146164: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcusparse.so.11
2020-09-21 15:19:06.146171: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-21 15:19:06.146944: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1762] Adding visible gpu devices: 0
2020-09-21 15:19:06.146968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1175] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-09-21 15:19:06.146972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181]      0
2020-09-21 15:19:06.146975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1194] 0:   N
2020-09-21 15:19:06.147745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1320] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 9031 MB memory) -> physical GPU (device: 0, name: GeForce RTX 3080, pci bus id: 0000:01:00.0, compute capability: 8.6)
2020-09-21 15:19:07.319279: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1648] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0921 15:19:07.488090 140493310977856 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0921 15:19:07.687747 140493310977856 session_manager.py:502] Done running local_init_op.
Running warm up
2020-09-21 15:19:10.748647: I tensorflow/core/grappler/optimizers/generic_layout_optimizer.cc:345] Cancel Transpose nodes around Pad: transpose_before=tower_0/v0/transpose pad=tower_0/v0/cg/conv0/Pad transpose_after=tower_0/v0/cg/conv0/conv2d/Conv2D-0-TransposeNCHWToNHWC-LayoutOptimizer,tower_0/v0/gradients/tower_0/v0/cg/conv0/conv2d/Conv2D_grad/Conv2DBackpropFilter-0-TransposeNCHWToNHWC-LayoutOptimizer
2020-09-21 15:19:14.052768: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcublas.so.11
2020-09-21 15:19:14.556601: I tensorflow/stream_executor/platform/default/dso_loader.cc:48] Successfully opened dynamic library libcudnn.so.8
2020-09-21 15:19:15.562455: W tensorflow/stream_executor/cuda/redzone_allocator.cc:312] Internal: ptxas exited with non-zero error code 65280, output: ptxas fatal   : Value 'sm_86' is not defined for option 'gpu-name'

Relying on driver to perform ptx compilation. This message will be only logged once.
2020-09-21 15:20:31.067613: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:70] Can't find ptxas binary in ${CUDA_DIR}/bin.  Will back to the GPU driver for PTX -> sass compilation.  This is OK so long as you don't see a warning below about an out-of-date driver version.
2020-09-21 15:20:31.067647: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:71] Searched for CUDA in the following directories:
2020-09-21 15:20:31.067657: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   ./cuda_sdk_lib
2020-09-21 15:20:31.067661: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   /usr/local/cuda
2020-09-21 15:20:31.067666: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   .
2020-09-21 15:20:31.067671: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:76] You can choose the search directory by setting xla_gpu_cuda_data_dir in HloModule's DebugOptions.  For most apps, setting the environment variable XLA_FLAGS=--xla_gpu_cuda_data_dir=/path/to/cuda will work.
2020-09-21 15:20:31.068276: I tensorflow/compiler/jit/xla_compilation_cache.cc:237] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2020-09-21 15:20:33.248131: W tensorflow/compiler/xla/service/gpu/buffer_comparator.cc:590] Internal: ptxas exited with non-zero error code 65280, output: ptxas fatal   : Value 'sm_86' is not defined for option 'gpu-name'

Relying on driver to perform ptx compilation. This message will be only logged once.
2020-09-21 15:22:47.358717: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:70] Can't find ptxas binary in ${CUDA_DIR}/bin.  Will back to the GPU driver for PTX -> sass compilation.  This is OK so long as you don't see a warning below about an out-of-date driver version.
2020-09-21 15:22:47.358750: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:71] Searched for CUDA in the following directories:
2020-09-21 15:22:47.358760: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   ./cuda_sdk_lib
2020-09-21 15:22:47.358765: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   /usr/local/cuda
2020-09-21 15:22:47.358769: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   .
2020-09-21 15:22:47.358774: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:76] You can choose the search directory by setting xla_gpu_cuda_data_dir in HloModule's DebugOptions.  For most apps, setting the environment variable XLA_FLAGS=--xla_gpu_cuda_data_dir=/path/to/cuda will work.
2020-09-21 15:22:53.542497: W tensorflow/core/common_runtime/bfc_allocator.cc:305] Garbage collection: deallocate free memory regions (i.e., allocations) so that we can re-allocate a larger region to avoid OOM due to memory fragmentation. If you see this message frequently, you are running near the threshold of the available device memory and re-allocation may incur great performance overhead. You may try smaller batch sizes to observe the performance impact. Set TF_ENABLE_GPU_GARBAGE_COLLECTION=false if you'd like to disable this feature.
2020-09-21 15:22:56.165661: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:70] Can't find ptxas binary in ${CUDA_DIR}/bin.  Will back to the GPU driver for PTX -> sass compilation.  This is OK so long as you don't see a warning below about an out-of-date driver version.
2020-09-21 15:22:56.165696: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:71] Searched for CUDA in the following directories:
2020-09-21 15:22:56.165706: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   ./cuda_sdk_lib
2020-09-21 15:22:56.165711: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   /usr/local/cuda
2020-09-21 15:22:56.165715: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:74]   .
2020-09-21 15:22:56.165720: W tensorflow/compiler/xla/service/gpu/nvptx_compiler.cc:76] You can choose the search directory by setting xla_gpu_cuda_data_dir in HloModule's DebugOptions.  For most apps, setting the environment variable XLA_FLAGS=--xla_gpu_cuda_data_dir=/path/to/cuda will work.
Done warm up
Step	Img/sec	total_loss
1	images/sec: 240.3 +/- 0.0 (jitter = 0.0)	8.751 1600701779
10	images/sec: 240.0 +/- 0.2 (jitter = 0.2)	8.747 1600701781
20	images/sec: 240.2 +/- 0.1 (jitter = 0.3)	8.797 1600701784
30	images/sec: 240.0 +/- 0.1 (jitter = 0.3)	8.804 1600701786
40	images/sec: 239.6 +/- 0.2 (jitter = 0.7)	8.935 1600701789
50	images/sec: 239.4 +/- 0.2 (jitter = 1.1)	9.108 1600701792
60	images/sec: 239.2 +/- 0.1 (jitter = 1.4)	8.672 1600701794
70	images/sec: 239.0 +/- 0.1 (jitter = 1.4)	8.832 1600701797
80	images/sec: 238.8 +/- 0.1 (jitter = 1.3)	8.818 1600701800
90	images/sec: 238.6 +/- 0.1 (jitter = 1.2)	8.892 1600701802
100	images/sec: 238.4 +/- 0.1 (jitter = 1.4)	8.745 1600701805
110	images/sec: 238.2 +/- 0.1 (jitter = 1.6)	8.566 1600701808
120	images/sec: 238.1 +/- 0.1 (jitter = 1.8)	8.853 1600701811
130	images/sec: 237.9 +/- 0.1 (jitter = 1.9)	8.842 1600701813
140	images/sec: 237.8 +/- 0.1 (jitter = 1.9)	8.971 1600701816
150	images/sec: 237.6 +/- 0.1 (jitter = 1.9)	8.915 1600701819
160	images/sec: 237.5 +/- 0.1 (jitter = 1.7)	8.989 1600701821
170	images/sec: 237.4 +/- 0.1 (jitter = 1.8)	9.024 1600701824
180	images/sec: 237.3 +/- 0.1 (jitter = 1.8)	8.861 1600701827
190	images/sec: 237.2 +/- 0.1 (jitter = 1.7)	8.819 1600701830
200	images/sec: 237.1 +/- 0.1 (jitter = 1.6)	8.819 1600701832
210	images/sec: 237.0 +/- 0.1 (jitter = 1.5)	8.684 1600701835
220	images/sec: 237.0 +/- 0.1 (jitter = 1.5)	8.894 1600701838
230	images/sec: 236.9 +/- 0.1 (jitter = 1.4)	8.752 1600701840
240	images/sec: 236.8 +/- 0.1 (jitter = 1.5)	8.800 1600701843
250	images/sec: 236.6 +/- 0.1 (jitter = 1.6)	8.806 1600701846
260	images/sec: 236.6 +/- 0.1 (jitter = 1.7)	8.703 1600701849
270	images/sec: 236.4 +/- 0.1 (jitter = 1.8)	8.829 1600701851
280	images/sec: 236.3 +/- 0.1 (jitter = 1.9)	8.997 1600701854
290	images/sec: 236.3 +/- 0.1 (jitter = 1.9)	8.546 1600701857
300	images/sec: 236.2 +/- 0.1 (jitter = 2.0)	8.880 1600701860
310	images/sec: 236.1 +/- 0.1 (jitter = 2.0)	8.850 1600701862
320	images/sec: 236.0 +/- 0.1 (jitter = 1.9)	8.756 1600701865
330	images/sec: 236.0 +/- 0.1 (jitter = 1.9)	9.040 1600701868
340	images/sec: 235.9 +/- 0.1 (jitter = 1.9)	8.676 1600701871
350	images/sec: 235.9 +/- 0.1 (jitter = 1.8)	8.879 1600701873
360	images/sec: 236.0 +/- 0.1 (jitter = 1.9)	8.760 1600701876
370	images/sec: 236.0 +/- 0.1 (jitter = 2.0)	8.687 1600701879
380	images/sec: 236.0 +/- 0.1 (jitter = 2.0)	8.786 1600701881
390	images/sec: 236.1 +/- 0.1 (jitter = 2.0)	8.866 1600701884
400	images/sec: 236.1 +/- 0.1 (jitter = 2.0)	8.971 1600701887
410	images/sec: 236.1 +/- 0.1 (jitter = 1.9)	8.941 1600701890
420	images/sec: 236.1 +/- 0.1 (jitter = 1.9)	8.925 1600701892
430	images/sec: 236.1 +/- 0.1 (jitter = 1.8)	8.866 1600701895
440	images/sec: 236.1 +/- 0.1 (jitter = 1.7)	8.965 1600701898
450	images/sec: 236.0 +/- 0.1 (jitter = 1.7)	8.787 1600701900
460	images/sec: 236.0 +/- 0.1 (jitter = 1.8)	8.685 1600701903
470	images/sec: 235.9 +/- 0.1 (jitter = 1.9)	8.815 1600701906
480	images/sec: 235.9 +/- 0.1 (jitter = 1.9)	8.716 1600701909
490	images/sec: 235.8 +/- 0.1 (jitter = 1.9)	8.852 1600701911
500	images/sec: 235.8 +/- 0.1 (jitter = 2.0)	8.877 1600701914
----------------------------------------------------------------
total images/sec: 235.74
----------------------------------------------------------------
