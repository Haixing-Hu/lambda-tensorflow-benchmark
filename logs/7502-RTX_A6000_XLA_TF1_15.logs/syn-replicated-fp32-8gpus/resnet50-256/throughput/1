2021-01-01 03:25:12.066290: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
2021-01-01 03:25:13.917611: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2500090000 Hz
2021-01-01 03:25:13.917789: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5c5d1a0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-01-01 03:25:13.917827: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-01-01 03:25:13.919733: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-01-01 03:25:15.845099: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5c45d10 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-01-01 03:25:15.845151: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.845161: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.845169: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.845176: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.845183: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (4): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.845191: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (5): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.845198: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (6): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.845205: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (7): RTX A6000, Compute Capability 8.6
2021-01-01 03:25:15.896019: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:01:00.0
2021-01-01 03:25:15.899428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 1 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:25:00.0
2021-01-01 03:25:15.902828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 2 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:41:00.0
2021-01-01 03:25:15.905066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 3 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:61:00.0
2021-01-01 03:25:15.907245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 4 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:81:00.0
2021-01-01 03:25:15.909985: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 5 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:a1:00.0
2021-01-01 03:25:15.913150: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 6 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:c1:00.0
2021-01-01 03:25:15.915336: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 7 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:e1:00.0
2021-01-01 03:25:15.915373: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-01-01 03:25:15.918147: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-01-01 03:25:15.919081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-01-01 03:25:15.919302: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-01-01 03:25:15.921686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2021-01-01 03:25:15.922238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-01-01 03:25:15.922361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-01-01 03:25:15.974385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2021-01-01 03:25:15.974432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-01-01 03:25:17.754746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-01-01 03:25:17.754830: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 2 3 4 5 6 7
2021-01-01 03:25:17.754837: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y Y Y Y Y Y Y
2021-01-01 03:25:17.754841: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N Y Y Y Y Y Y
2021-01-01 03:25:17.754845: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 2:   Y Y N Y Y Y Y Y
2021-01-01 03:25:17.754849: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 3:   Y Y Y N Y Y Y Y
2021-01-01 03:25:17.754853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 4:   Y Y Y Y N Y Y Y
2021-01-01 03:25:17.754857: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 5:   Y Y Y Y Y N Y Y
2021-01-01 03:25:17.754860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 6:   Y Y Y Y Y Y N Y
2021-01-01 03:25:17.754864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 7:   Y Y Y Y Y Y Y N
2021-01-01 03:25:17.775107: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.775148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 46774 MB memory) -> physical GPU (device: 0, name: RTX A6000, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-01-01 03:25:17.777944: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.777964: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 46774 MB memory) -> physical GPU (device: 1, name: RTX A6000, pci bus id: 0000:25:00.0, compute capability: 8.6)
2021-01-01 03:25:17.780626: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.780646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 46774 MB memory) -> physical GPU (device: 2, name: RTX A6000, pci bus id: 0000:41:00.0, compute capability: 8.6)
2021-01-01 03:25:17.783231: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.783253: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 46774 MB memory) -> physical GPU (device: 3, name: RTX A6000, pci bus id: 0000:61:00.0, compute capability: 8.6)
2021-01-01 03:25:17.788991: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.789036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 46774 MB memory) -> physical GPU (device: 4, name: RTX A6000, pci bus id: 0000:81:00.0, compute capability: 8.6)
2021-01-01 03:25:17.795072: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.795112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 46774 MB memory) -> physical GPU (device: 5, name: RTX A6000, pci bus id: 0000:a1:00.0, compute capability: 8.6)
2021-01-01 03:25:17.799967: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.799999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 46774 MB memory) -> physical GPU (device: 6, name: RTX A6000, pci bus id: 0000:c1:00.0, compute capability: 8.6)
2021-01-01 03:25:17.803154: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:25:17.803177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 46774 MB memory) -> physical GPU (device: 7, name: RTX A6000, pci bus id: 0000:e1:00.0, compute capability: 8.6)
TensorFlow:  1.15
Model:       resnet50
Dataset:     imagenet (synthetic)
Mode:        training
SingleSess:  False
Batch size:  2048 global
256 per device
Num batches: 100
Num epochs:  0.16
Devices:     ['/gpu:0', '/gpu:1', '/gpu:2', '/gpu:3', '/gpu:4', '/gpu:5', '/gpu:6', '/gpu:7']
NUMA bind:   False
Data format: NCHW
Optimizer:   sgd
Variables:   replicated
AllReduce:   nccl
==========
Generating training model
Initializing graph
2021-01-01 03:25:36.106371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:01:00.0
2021-01-01 03:25:36.108756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 1 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:25:00.0
2021-01-01 03:25:36.111156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 2 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:41:00.0
2021-01-01 03:25:36.113513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 3 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:61:00.0
2021-01-01 03:25:36.116775: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 4 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:81:00.0
2021-01-01 03:25:36.123239: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 5 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:a1:00.0
2021-01-01 03:25:36.128993: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 6 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:c1:00.0
2021-01-01 03:25:36.133756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 7 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:e1:00.0
2021-01-01 03:25:36.133834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-01-01 03:25:36.133995: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-01-01 03:25:36.134020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-01-01 03:25:36.134034: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-01-01 03:25:36.134050: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2021-01-01 03:25:36.134068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-01-01 03:25:36.134084: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-01-01 03:25:36.216623: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2021-01-01 03:25:36.216911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-01-01 03:25:36.216926: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 2 3 4 5 6 7
2021-01-01 03:25:36.216933: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y Y Y Y Y Y Y
2021-01-01 03:25:36.216939: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N Y Y Y Y Y Y
2021-01-01 03:25:36.216945: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 2:   Y Y N Y Y Y Y Y
2021-01-01 03:25:36.216950: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 3:   Y Y Y N Y Y Y Y
2021-01-01 03:25:36.216956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 4:   Y Y Y Y N Y Y Y
2021-01-01 03:25:36.216962: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 5:   Y Y Y Y Y N Y Y
2021-01-01 03:25:36.216968: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 6:   Y Y Y Y Y Y N Y
2021-01-01 03:25:36.216974: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 7:   Y Y Y Y Y Y Y N
2021-01-01 03:25:36.254053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 46774 MB memory) -> physical GPU (device: 0, name: RTX A6000, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-01-01 03:25:36.256508: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 46774 MB memory) -> physical GPU (device: 1, name: RTX A6000, pci bus id: 0000:25:00.0, compute capability: 8.6)
2021-01-01 03:25:36.258954: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 46774 MB memory) -> physical GPU (device: 2, name: RTX A6000, pci bus id: 0000:41:00.0, compute capability: 8.6)
2021-01-01 03:25:36.261405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 46774 MB memory) -> physical GPU (device: 3, name: RTX A6000, pci bus id: 0000:61:00.0, compute capability: 8.6)
2021-01-01 03:25:36.264318: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 46774 MB memory) -> physical GPU (device: 4, name: RTX A6000, pci bus id: 0000:81:00.0, compute capability: 8.6)
2021-01-01 03:25:36.266758: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 46774 MB memory) -> physical GPU (device: 5, name: RTX A6000, pci bus id: 0000:a1:00.0, compute capability: 8.6)
2021-01-01 03:25:36.269210: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 46774 MB memory) -> physical GPU (device: 6, name: RTX A6000, pci bus id: 0000:c1:00.0, compute capability: 8.6)
2021-01-01 03:25:36.271635: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 46774 MB memory) -> physical GPU (device: 7, name: RTX A6000, pci bus id: 0000:e1:00.0, compute capability: 8.6)
2021-01-01 03:25:41.171650: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1648] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0101 03:25:43.047047 139714070759232 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0101 03:25:45.583822 139714070759232 session_manager.py:502] Done running local_init_op.
Running warm up
2021-01-01 03:25:56.750453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-01-01 03:25:57.527756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-01-01 03:26:18.640124: I tensorflow/compiler/jit/xla_compilation_cache.cc:241] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
2021-01-01 03:26:48.422251: W tensorflow/core/common_runtime/bfc_allocator.cc:305] Garbage collection: deallocate free memory regions (i.e., allocations) so that we can re-allocate a larger region to avoid OOM due to memory fragmentation. If you see this message frequently, you are running near the threshold of the available device memory and re-allocation may incur great performance overhead. You may try smaller batch sizes to observe the performance impact. Set TF_ENABLE_GPU_GARBAGE_COLLECTION=false if you'd like to disable this feature.
Done warm up
Step	Img/sec	total_loss
1	images/sec: 4315.5 +/- 0.0 (jitter = 0.0)	7.849 1609471618
10	images/sec: 4305.5 +/- 3.7 (jitter = 12.2)	7.743 1609471622
20	images/sec: 4305.5 +/- 3.3 (jitter = 9.3)	7.696 1609471627
30	images/sec: 4304.2 +/- 2.4 (jitter = 11.0)	7.579 1609471632
40	images/sec: 4298.6 +/- 3.0 (jitter = 14.9)	7.561 1609471636
50	images/sec: 4296.7 +/- 2.5 (jitter = 15.2)	7.520 1609471641
60	images/sec: 4294.1 +/- 2.2 (jitter = 16.4)	7.494 1609471646
70	images/sec: 4291.0 +/- 2.2 (jitter = 18.3)	7.494 1609471651
80	images/sec: 4288.2 +/- 2.1 (jitter = 21.8)	7.472 1609471656
90	images/sec: 4284.2 +/- 2.3 (jitter = 24.2)	7.463 1609471660
100	images/sec: 4281.4 +/- 2.3 (jitter = 26.4)	7.475 1609471665
----------------------------------------------------------------
total images/sec: 4280.37
----------------------------------------------------------------
