2021-01-01 03:10:27.946976: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
2021-01-01 03:10:29.837619: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2500090000 Hz
2021-01-01 03:10:29.837867: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5a3c100 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-01-01 03:10:29.837911: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-01-01 03:10:29.841603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2021-01-01 03:10:31.788074: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5c7fa80 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-01-01 03:10:31.788131: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.788142: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.788151: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.788159: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.788168: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (4): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.788177: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (5): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.788186: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (6): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.788194: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (7): RTX A6000, Compute Capability 8.6
2021-01-01 03:10:31.835255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:01:00.0
2021-01-01 03:10:31.837494: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 1 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:25:00.0
2021-01-01 03:10:31.839664: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 2 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:41:00.0
2021-01-01 03:10:31.841852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 3 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:61:00.0
2021-01-01 03:10:31.844018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 4 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:81:00.0
2021-01-01 03:10:31.846208: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 5 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:a1:00.0
2021-01-01 03:10:31.848390: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 6 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:c1:00.0
2021-01-01 03:10:31.850565: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 7 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:e1:00.0
2021-01-01 03:10:31.850588: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-01-01 03:10:31.852921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-01-01 03:10:31.853734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-01-01 03:10:31.853929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-01-01 03:10:31.856511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2021-01-01 03:10:31.856991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-01-01 03:10:31.857100: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-01-01 03:10:31.906640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2021-01-01 03:10:31.906690: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-01-01 03:10:33.756475: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-01-01 03:10:33.756534: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 2 3 4 5 6 7
2021-01-01 03:10:33.756541: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y Y Y Y Y Y Y
2021-01-01 03:10:33.756545: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N Y Y Y Y Y Y
2021-01-01 03:10:33.756549: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 2:   Y Y N Y Y Y Y Y
2021-01-01 03:10:33.756553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 3:   Y Y Y N Y Y Y Y
2021-01-01 03:10:33.756557: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 4:   Y Y Y Y N Y Y Y
2021-01-01 03:10:33.756560: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 5:   Y Y Y Y Y N Y Y
2021-01-01 03:10:33.756564: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 6:   Y Y Y Y Y Y N Y
2021-01-01 03:10:33.756567: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 7:   Y Y Y Y Y Y Y N
2021-01-01 03:10:33.776650: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.776692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 46774 MB memory) -> physical GPU (device: 0, name: RTX A6000, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-01-01 03:10:33.779326: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.779349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 46774 MB memory) -> physical GPU (device: 1, name: RTX A6000, pci bus id: 0000:25:00.0, compute capability: 8.6)
2021-01-01 03:10:33.781889: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.781909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 46774 MB memory) -> physical GPU (device: 2, name: RTX A6000, pci bus id: 0000:41:00.0, compute capability: 8.6)
2021-01-01 03:10:33.784380: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.784397: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 46774 MB memory) -> physical GPU (device: 3, name: RTX A6000, pci bus id: 0000:61:00.0, compute capability: 8.6)
2021-01-01 03:10:33.786990: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.787010: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 46774 MB memory) -> physical GPU (device: 4, name: RTX A6000, pci bus id: 0000:81:00.0, compute capability: 8.6)
2021-01-01 03:10:33.789765: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.789784: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 46774 MB memory) -> physical GPU (device: 5, name: RTX A6000, pci bus id: 0000:a1:00.0, compute capability: 8.6)
2021-01-01 03:10:33.793278: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.793298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 46774 MB memory) -> physical GPU (device: 6, name: RTX A6000, pci bus id: 0000:c1:00.0, compute capability: 8.6)
2021-01-01 03:10:33.797268: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2021-01-01 03:10:33.797289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 46774 MB memory) -> physical GPU (device: 7, name: RTX A6000, pci bus id: 0000:e1:00.0, compute capability: 8.6)
TensorFlow:  1.15
Model:       vgg16
Dataset:     imagenet (synthetic)
Mode:        training
SingleSess:  False
Batch size:  4096 global
512 per device
Num batches: 100
Num epochs:  0.32
Devices:     ['/gpu:0', '/gpu:1', '/gpu:2', '/gpu:3', '/gpu:4', '/gpu:5', '/gpu:6', '/gpu:7']
NUMA bind:   False
Data format: NCHW
Optimizer:   sgd
Variables:   replicated
AllReduce:   nccl
==========
Generating training model
Initializing graph
2021-01-01 03:10:37.273770: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:01:00.0
2021-01-01 03:10:37.278673: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 1 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:25:00.0
2021-01-01 03:10:37.282492: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 2 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:41:00.0
2021-01-01 03:10:37.285536: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 3 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:61:00.0
2021-01-01 03:10:37.287721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 4 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:81:00.0
2021-01-01 03:10:37.290593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 5 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:a1:00.0
2021-01-01 03:10:37.295067: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 6 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:c1:00.0
2021-01-01 03:10:37.299477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 7 with properties:
name: RTX A6000 major: 8 minor: 6 memoryClockRate(GHz): 1.8
pciBusID: 0000:e1:00.0
2021-01-01 03:10:37.299520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2021-01-01 03:10:37.299556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-01-01 03:10:37.299569: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2021-01-01 03:10:37.299581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2021-01-01 03:10:37.299592: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2021-01-01 03:10:37.299603: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2021-01-01 03:10:37.299615: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-01-01 03:10:37.343212: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2021-01-01 03:10:37.343349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-01-01 03:10:37.343356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 2 3 4 5 6 7
2021-01-01 03:10:37.343360: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y Y Y Y Y Y Y
2021-01-01 03:10:37.343364: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N Y Y Y Y Y Y
2021-01-01 03:10:37.343368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 2:   Y Y N Y Y Y Y Y
2021-01-01 03:10:37.343371: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 3:   Y Y Y N Y Y Y Y
2021-01-01 03:10:37.343375: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 4:   Y Y Y Y N Y Y Y
2021-01-01 03:10:37.343378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 5:   Y Y Y Y Y N Y Y
2021-01-01 03:10:37.343382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 6:   Y Y Y Y Y Y N Y
2021-01-01 03:10:37.343385: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 7:   Y Y Y Y Y Y Y N
2021-01-01 03:10:37.378606: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 46774 MB memory) -> physical GPU (device: 0, name: RTX A6000, pci bus id: 0000:01:00.0, compute capability: 8.6)
2021-01-01 03:10:37.384170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 46774 MB memory) -> physical GPU (device: 1, name: RTX A6000, pci bus id: 0000:25:00.0, compute capability: 8.6)
2021-01-01 03:10:37.389481: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 46774 MB memory) -> physical GPU (device: 2, name: RTX A6000, pci bus id: 0000:41:00.0, compute capability: 8.6)
2021-01-01 03:10:37.395855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 46774 MB memory) -> physical GPU (device: 3, name: RTX A6000, pci bus id: 0000:61:00.0, compute capability: 8.6)
2021-01-01 03:10:37.401298: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 46774 MB memory) -> physical GPU (device: 4, name: RTX A6000, pci bus id: 0000:81:00.0, compute capability: 8.6)
2021-01-01 03:10:37.405937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 46774 MB memory) -> physical GPU (device: 5, name: RTX A6000, pci bus id: 0000:a1:00.0, compute capability: 8.6)
2021-01-01 03:10:37.411324: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 46774 MB memory) -> physical GPU (device: 6, name: RTX A6000, pci bus id: 0000:c1:00.0, compute capability: 8.6)
2021-01-01 03:10:37.416101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 46774 MB memory) -> physical GPU (device: 7, name: RTX A6000, pci bus id: 0000:e1:00.0, compute capability: 8.6)
2021-01-01 03:10:37.985618: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1648] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I0101 03:10:39.232729 140115037390656 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I0101 03:10:39.705796 140115037390656 session_manager.py:502] Done running local_init_op.
Running warm up
2021-01-01 03:10:42.531333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2021-01-01 03:10:43.371026: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2021-01-01 03:12:47.074967: I tensorflow/compiler/jit/xla_compilation_cache.cc:241] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
Done warm up
Step	Img/sec	total_loss
1	images/sec: 5900.3 +/- 0.0 (jitter = 0.0)	nan 1609470866
10	images/sec: 5906.5 +/- 5.6 (jitter = 14.9)	nan 1609470873
20	images/sec: 5904.3 +/- 3.9 (jitter = 16.5)	nan 1609470880
30	images/sec: 5898.4 +/- 4.2 (jitter = 17.0)	nan 1609470887
40	images/sec: 5890.6 +/- 4.4 (jitter = 21.1)	nan 1609470894
50	images/sec: 5883.5 +/- 4.4 (jitter = 28.4)	nan 1609470901
60	images/sec: 5876.7 +/- 4.6 (jitter = 35.0)	nan 1609470908
70	images/sec: 5868.6 +/- 5.0 (jitter = 41.4)	nan 1609470915
80	images/sec: 5861.7 +/- 5.0 (jitter = 49.2)	nan 1609470922
90	images/sec: 5854.5 +/- 5.2 (jitter = 58.1)	nan 1609470929
100	images/sec: 5851.2 +/- 4.9 (jitter = 61.2)	nan 1609470936
----------------------------------------------------------------
total images/sec: 5850.34
----------------------------------------------------------------
