2020-11-01 17:12:50.133238: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
WARNING:tensorflow:Deprecation warnings have been disabled. Set TF_ENABLE_DEPRECATION_WARNINGS=1 to re-enable them.
2020-11-01 17:12:51.948636: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2500105000 Hz
2020-11-01 17:12:51.948838: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x58925c0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-11-01 17:12:51.948883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-11-01 17:12:51.952980: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2020-11-01 17:12:53.407283: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5a9cca0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-11-01 17:12:53.407331: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.407339: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (1): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.407346: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (2): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.407353: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (3): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.407359: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (4): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.407365: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (5): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.407372: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (6): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.407379: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (7): A100-PCIE-40GB, Compute Capability 8.0
2020-11-01 17:12:53.557188: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:01:00.0
2020-11-01 17:12:53.559693: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 1 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:25:00.0
2020-11-01 17:12:53.562129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 2 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:41:00.0
2020-11-01 17:12:53.564542: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 3 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:61:00.0
2020-11-01 17:12:53.566999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 4 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:81:00.0
2020-11-01 17:12:53.569414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 5 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:a1:00.0
2020-11-01 17:12:53.571855: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 6 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:c1:00.0
2020-11-01 17:12:53.574316: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 7 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:e1:00.0
2020-11-01 17:12:53.574347: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2020-11-01 17:12:53.576629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2020-11-01 17:12:53.577436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2020-11-01 17:12:53.577629: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2020-11-01 17:12:53.579984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2020-11-01 17:12:53.580479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2020-11-01 17:12:53.580617: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2020-11-01 17:12:53.624164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2020-11-01 17:12:53.624195: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2020-11-01 17:12:55.423859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-11-01 17:12:55.423932: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 2 3 4 5 6 7
2020-11-01 17:12:55.423938: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y Y Y Y Y Y Y
2020-11-01 17:12:55.423942: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N Y Y Y Y Y Y
2020-11-01 17:12:55.423946: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 2:   Y Y N Y Y Y Y Y
2020-11-01 17:12:55.423949: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 3:   Y Y Y N Y Y Y Y
2020-11-01 17:12:55.423952: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 4:   Y Y Y Y N Y Y Y
2020-11-01 17:12:55.423956: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 5:   Y Y Y Y Y N Y Y
2020-11-01 17:12:55.423959: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 6:   Y Y Y Y Y Y N Y
2020-11-01 17:12:55.423963: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 7:   Y Y Y Y Y Y Y N
2020-11-01 17:12:55.445131: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.445165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38472 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:01:00.0, compute capability: 8.0)
2020-11-01 17:12:55.448073: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.448092: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 38472 MB memory) -> physical GPU (device: 1, name: A100-PCIE-40GB, pci bus id: 0000:25:00.0, compute capability: 8.0)
2020-11-01 17:12:55.450693: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.450715: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 38472 MB memory) -> physical GPU (device: 2, name: A100-PCIE-40GB, pci bus id: 0000:41:00.0, compute capability: 8.0)
2020-11-01 17:12:55.453391: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.453409: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 38472 MB memory) -> physical GPU (device: 3, name: A100-PCIE-40GB, pci bus id: 0000:61:00.0, compute capability: 8.0)
2020-11-01 17:12:55.456079: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.456097: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 38472 MB memory) -> physical GPU (device: 4, name: A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0)
2020-11-01 17:12:55.458751: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.458774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 38472 MB memory) -> physical GPU (device: 5, name: A100-PCIE-40GB, pci bus id: 0000:a1:00.0, compute capability: 8.0)
2020-11-01 17:12:55.461408: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.461428: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 38472 MB memory) -> physical GPU (device: 6, name: A100-PCIE-40GB, pci bus id: 0000:c1:00.0, compute capability: 8.0)
2020-11-01 17:12:55.464092: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:39] Overriding allow_growth setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2020-11-01 17:12:55.464110: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 38472 MB memory) -> physical GPU (device: 7, name: A100-PCIE-40GB, pci bus id: 0000:e1:00.0, compute capability: 8.0)
TensorFlow:  1.15
Model:       vgg16
Dataset:     imagenet (synthetic)
Mode:        training
SingleSess:  False
Batch size:  1792 global
224 per device
Num batches: 100
Num epochs:  0.14
Devices:     ['/gpu:0', '/gpu:1', '/gpu:2', '/gpu:3', '/gpu:4', '/gpu:5', '/gpu:6', '/gpu:7']
NUMA bind:   False
Data format: NCHW
Optimizer:   sgd
Variables:   replicated
AllReduce:   nccl
==========
Generating training model
Initializing graph
2020-11-01 17:12:58.246470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 0 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:01:00.0
2020-11-01 17:12:58.248870: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 1 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:25:00.0
2020-11-01 17:12:58.251151: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 2 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:41:00.0
2020-11-01 17:12:58.253498: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 3 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:61:00.0
2020-11-01 17:12:58.255839: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 4 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:81:00.0
2020-11-01 17:12:58.258138: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 5 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:a1:00.0
2020-11-01 17:12:58.260415: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 6 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:c1:00.0
2020-11-01 17:12:58.262676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1665] Found device 7 with properties:
name: A100-PCIE-40GB major: 8 minor: 0 memoryClockRate(GHz): 1.41
pciBusID: 0000:e1:00.0
2020-11-01 17:12:58.262707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2020-11-01 17:12:58.262738: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2020-11-01 17:12:58.262748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2020-11-01 17:12:58.262757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2020-11-01 17:12:58.262766: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.11
2020-11-01 17:12:58.262775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2020-11-01 17:12:58.262783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2020-11-01 17:12:58.306700: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1793] Adding visible gpu devices: 0, 1, 2, 3, 4, 5, 6, 7
2020-11-01 17:12:58.306846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1206] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-11-01 17:12:58.306853: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212]      0 1 2 3 4 5 6 7
2020-11-01 17:12:58.306859: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 0:   N Y Y Y Y Y Y Y
2020-11-01 17:12:58.306864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 1:   Y N Y Y Y Y Y Y
2020-11-01 17:12:58.306868: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 2:   Y Y N Y Y Y Y Y
2020-11-01 17:12:58.306873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 3:   Y Y Y N Y Y Y Y
2020-11-01 17:12:58.306877: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 4:   Y Y Y Y N Y Y Y
2020-11-01 17:12:58.306882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 5:   Y Y Y Y Y N Y Y
2020-11-01 17:12:58.306886: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 6:   Y Y Y Y Y Y N Y
2020-11-01 17:12:58.306890: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1225] 7:   Y Y Y Y Y Y Y N
2020-11-01 17:12:58.327506: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 38472 MB memory) -> physical GPU (device: 0, name: A100-PCIE-40GB, pci bus id: 0000:01:00.0, compute capability: 8.0)
2020-11-01 17:12:58.329911: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 38472 MB memory) -> physical GPU (device: 1, name: A100-PCIE-40GB, pci bus id: 0000:25:00.0, compute capability: 8.0)
2020-11-01 17:12:58.332366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 38472 MB memory) -> physical GPU (device: 2, name: A100-PCIE-40GB, pci bus id: 0000:41:00.0, compute capability: 8.0)
2020-11-01 17:12:58.334746: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 38472 MB memory) -> physical GPU (device: 3, name: A100-PCIE-40GB, pci bus id: 0000:61:00.0, compute capability: 8.0)
2020-11-01 17:12:58.337137: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:4 with 38472 MB memory) -> physical GPU (device: 4, name: A100-PCIE-40GB, pci bus id: 0000:81:00.0, compute capability: 8.0)
2020-11-01 17:12:58.339521: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:5 with 38472 MB memory) -> physical GPU (device: 5, name: A100-PCIE-40GB, pci bus id: 0000:a1:00.0, compute capability: 8.0)
2020-11-01 17:12:58.341896: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:6 with 38472 MB memory) -> physical GPU (device: 6, name: A100-PCIE-40GB, pci bus id: 0000:c1:00.0, compute capability: 8.0)
2020-11-01 17:12:58.344266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1351] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:7 with 38472 MB memory) -> physical GPU (device: 7, name: A100-PCIE-40GB, pci bus id: 0000:e1:00.0, compute capability: 8.0)
2020-11-01 17:12:58.829161: W tensorflow/compiler/jit/mark_for_compilation_pass.cc:1648] (One-time warning): Not using XLA:CPU for cluster because envvar TF_XLA_FLAGS=--tf_xla_cpu_global_jit was not set.  If you want XLA:CPU, either set that envvar, or use experimental_jit_scope to enable XLA:CPU.  To confirm that XLA is active, pass --vmodule=xla_compilation_cache=1 (as a proper command-line flag, not via TF_XLA_FLAGS) or set the envvar XLA_FLAGS=--xla_hlo_profile.
INFO:tensorflow:Running local_init_op.
I1101 17:13:00.218989 140429021787968 session_manager.py:500] Running local_init_op.
INFO:tensorflow:Done running local_init_op.
I1101 17:13:00.766364 140429021787968 session_manager.py:502] Done running local_init_op.
Running warm up
2020-11-01 17:13:02.279453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2020-11-01 17:13:03.229364: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2020-11-01 17:14:00.471326: I tensorflow/compiler/jit/xla_compilation_cache.cc:241] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
Done warm up
Step	Img/sec	total_loss
1	images/sec: 4107.5 +/- 0.0 (jitter = 0.0)	nan 1604250871
10	images/sec: 4106.3 +/- 2.1 (jitter = 8.6)	nan 1604250875
20	images/sec: 4102.7 +/- 2.0 (jitter = 6.3)	nan 1604250879
30	images/sec: 4097.8 +/- 1.9 (jitter = 11.8)	nan 1604250884
40	images/sec: 4093.3 +/- 1.9 (jitter = 14.2)	nan 1604250888
50	images/sec: 4088.3 +/- 2.1 (jitter = 18.6)	nan 1604250893
60	images/sec: 4084.0 +/- 2.4 (jitter = 18.7)	nan 1604250897
70	images/sec: 4081.5 +/- 2.2 (jitter = 16.5)	nan 1604250901
80	images/sec: 4078.9 +/- 2.1 (jitter = 18.5)	nan 1604250906
90	images/sec: 4076.8 +/- 2.0 (jitter = 18.7)	nan 1604250910
100	images/sec: 4074.6 +/- 1.9 (jitter = 17.1)	nan 1604250915
----------------------------------------------------------------
total images/sec: 4073.72
----------------------------------------------------------------
